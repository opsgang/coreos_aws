# vim: et sr sw=4 ts=4 smartindent syntax=sh:
#
export AWS_MD_URL='http://169.254.169.254/latest'

aws_userdata_help() {
    cat <<EOM
usage: aws_userdata
... prints userdata as provided on launch
EOM

}

aws_userdata() {
    curl -s $AWS_MD_URL/user-data
}

aws_iam_help() {
    cat <<EOM
usage: aws_iam
... prints instance's iam arn
EOM

}

aws_iam() {
    curl -s $AWS_MD_URL/meta-data/iam/info | jq -r '.InstanceProfileArn'
}

aws_region_help() {
    cat <<EOM
usage: aws_region
... prints instance's aws region
EOM

}

aws_region() {
    curl -s $AWS_MD_URL/dynamic/instance-identity/document \
    | jq -r .availabilityZone | sed -e 's/[a-c]$//'
}

